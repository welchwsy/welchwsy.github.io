"use strict";(self.webpackChunkdocusaurus_blog=self.webpackChunkdocusaurus_blog||[]).push([[2809],{3905:function(e,t,a){a.d(t,{Zo:function(){return m},kt:function(){return d}});var r=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var p=r.createContext({}),s=function(e){var t=r.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},m=function(e){var t=s(e.components);return r.createElement(p.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,p=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),u=s(a),d=n,k=u["".concat(p,".").concat(d)]||u[d]||c[d]||i;return a?r.createElement(k,o(o({ref:t},m),{},{components:a})):r.createElement(k,o({ref:t},m))}));function d(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,o=new Array(i);o[0]=u;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:n,o[1]=l;for(var s=2;s<i;s++)o[s]=a[s];return r.createElement.apply(null,o)}return r.createElement.apply(null,a)}u.displayName="MDXCreateElement"},1722:function(e,t,a){a.r(t),a.d(t,{assets:function(){return m},contentTitle:function(){return p},default:function(){return d},frontMatter:function(){return l},metadata:function(){return s},toc:function(){return c}});var r=a(7462),n=a(3366),i=(a(7294),a(3905)),o=["components"],l={sidebar_position:6},p="\u5408\u6210\u56fe\u50cf",s={unversionedId:"\u5408\u6210\u56fe\u50cf",id:"\u5408\u6210\u56fe\u50cf",title:"\u5408\u6210\u56fe\u50cf",description:"composite",source:"@site/docs/\u5408\u6210\u56fe\u50cf.md",sourceDirName:".",slug:"/\u5408\u6210\u56fe\u50cf",permalink:"/docs/\u5408\u6210\u56fe\u50cf",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/\u5408\u6210\u56fe\u50cf.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"\u8c03\u6574\u56fe\u7247\u5927\u5c0f",permalink:"/docs/\u8c03\u6574\u56fe\u7247\u5927\u5c0f"},next:{title:"\u56fe\u50cf\u64cd\u4f5c",permalink:"/docs/\u56fe\u50cf\u64cd\u4f5c"}},m={},c=[{value:"composite",id:"composite",level:2},{value:"\u53c2\u6570",id:"\u53c2\u6570",level:3},{value:"\u4f8b\u5b50",id:"\u4f8b\u5b50",level:3}],u={toc:c};function d(e){var t=e.components,a=(0,n.Z)(e,o);return(0,i.kt)("wrapper",(0,r.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"\u5408\u6210\u56fe\u50cf"},"\u5408\u6210\u56fe\u50cf"),(0,i.kt)("h2",{id:"composite"},"composite"),(0,i.kt)("p",null,"\u5728\u5df2\u5904\u7406\uff08\u8c03\u6574\u5927\u5c0f\uff0c\u63d0\u53d6\u7b49\uff09\u56fe\u50cf\u4e0a\u7684\u5408\u6210\u56fe\u50cf\u3002"),(0,i.kt)("p",null,"\u8981\u5408\u6210\u7684\u56fe\u50cf\u5fc5\u987b\u4e0e\u5904\u7406\u540e\u7684\u56fe\u50cf\u76f8\u540c\u6216\u66f4\u5c0f\u3002\u5982\u679c\u540c\u65f6\u63d0\u4f9b",(0,i.kt)("inlineCode",{parentName:"p"},"top"),"\u548c",(0,i.kt)("inlineCode",{parentName:"p"},"left"),"\u9009\u9879\uff0c\u5219\u5b83\u4eec\u4f18\u5148\u4e8e",(0,i.kt)("inlineCode",{parentName:"p"},"gravity"),"\u3002"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"blend")," \u9009\u9879\u53ef\u4ee5\u662f\u5176\u4e2d\u7684\u4e00\u4e2a\uff1a",(0,i.kt)("inlineCode",{parentName:"p"},"clear"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"source"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"over"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"in"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"out"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"atop"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"dest"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"dest-over"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"dest-in"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"dest-out"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"dest-atop"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"xor"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"add"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"saturate"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"multiply"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"screen"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"overlay"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"darken"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"lighten"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"colour-dodge"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"color-dodge"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"colour-burn"),",",(0,i.kt)("inlineCode",{parentName:"p"},"color-burn"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"hard-light"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"soft-light"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"difference"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"exclusion"),"."),(0,i.kt)("p",null,"\u6709\u5173\u6df7\u5408\u6a21\u5f0f\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1 ",(0,i.kt)("a",{parentName:"p",href:"https://libvips.github.io/libvips/API/current/libvips-conversion.html#VipsBlendMode"},"https://libvips.github.io/libvips/API/current/libvips-conversion.html#VipsBlendMode")," \u548c ",(0,i.kt)("a",{parentName:"p",href:"https://www.cairographics.org/operators/"},"https://www.cairographics.org/operators/")),(0,i.kt)("h3",{id:"\u53c2\u6570"},"\u53c2\u6570"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"images")," ",(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array"},"Array")," <",(0,i.kt)("a",{parentName:"strong",href:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object"},"Object")," ",">")," \u8981\u5408\u6210\u7684\u56fe\u50cf\u7684\u6709\u5e8f\u5217\u8868    ",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"images[].input")," ",(0,i.kt)("strong",{parentName:"li"},"(",(0,i.kt)("a",{parentName:"strong",href:"https://nodejs.org/api/buffer.html"},"Buffer")," | ",(0,i.kt)("a",{parentName:"strong",href:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String"},"String")," )?")," \u5305\u542b\u56fe\u50cf\u6570\u636e\u7684\u7f13\u51b2\u533a\uff0c\u5305\u542b\u56fe\u50cf\u6587\u4ef6\u8def\u5f84\u7684String\u6216Create\u5bf9\u8c61\uff08\u8bf7\u53c2\u89c1\u4e0b\u6587\uff09",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"images[].input.create")," ",(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object"},"Object")," ?")," \u63cf\u8ff0\u4e86\u8981\u521b\u5efa\u7684\u7a7a\u767d\u8986\u76d6\u3002",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"images[].input.create.width")," ",(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number"},"Number \u6570\u76ee")," ?")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"images[].input.create.height")," ",(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number"},"Number \u6570\u76ee")," ?")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"images[].input.create.channels")," ",(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number"},"Number \u6570\u76ee")," ?")," 3-4"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"images[].input.create.background")," ",(0,i.kt)("strong",{parentName:"li"},"(",(0,i.kt)("a",{parentName:"strong",href:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String"},"String \u5b57\u7b26\u4e32")," | ",(0,i.kt)("a",{parentName:"strong",href:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object"},"Object \u5bf9\u8c61")," )? )\uff1f")," \u7531 ",(0,i.kt)("a",{parentName:"li",href:"https://www.npmjs.org/package/color"},"color \u989c\u8272"),"\u6a21\u5757\u63d0\u53d6\u7ea2\u8272\uff0c\u7eff\u8272\uff0c\u84dd\u8272\u548c\u963f\u5c14\u6cd5\u503c"))))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"images[].blend")," ",(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String"},"String"))," \u5982\u4f55\u5c06\u6b64\u56fe\u50cf\u4e0e\u4e0b\u9762\u7684\u56fe\u50cf\u6df7\u5408\u3002(\u53ef\u9009\uff0c\u9ed8\u8ba4 ",(0,i.kt)("inlineCode",{parentName:"li"},"'over'"),")        "),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"images[].gravity")," ",(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String"},"String"))," \u653e\u7f6e\u53e0\u52a0\u5c42\u7684\u4f4d\u7f6e\u3002 (\u53ef\u9009\uff0c\u9ed8\u8ba4 ",(0,i.kt)("inlineCode",{parentName:"li"},"'centre'"),")"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"images[].top")," ",(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number"},"Number")," ?")," \u8ddd\u4e0a\u8fb9\u7f18\u7684\u50cf\u7d20\u504f\u79fb\u91cf\u3002"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"images[].left")," ",(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number"},"Number")," ?")," \u8ddd\u5de6\u8fb9\u7f18\u7684\u50cf\u7d20\u504f\u79fb\u91cf\u3002"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"images[].tile")," ",(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean"},"Boolean"))," \u8bbe\u7f6e\u4e3a",(0,i.kt)("inlineCode",{parentName:"li"},"true"),"\u7684\u53ef\u4f7f\u7528\u7ed9\u5b9a\u7684",(0,i.kt)("inlineCode",{parentName:"li"},"gravity"),"\u5728\u6574\u4e2a\u56fe\u50cf\u4e0a\u91cd\u590d\u8986\u76d6\u56fe\u50cf\u3002(\u53ef\u9009\uff0c\u9ed8\u8ba4\u4e3a false)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"images[].premultiplied")," ",(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean"},"Boolean"))," \u8bbe\u7f6e\u4e3a",(0,i.kt)("inlineCode",{parentName:"li"},"true"),"\u4ee5\u907f\u514d\u9884\u4e58\u4e0b\u56fe\u3002\u7b49\u540c\u4e8e",(0,i.kt)("inlineCode",{parentName:"li"},"--premultiplied")," vips\u9009\u9879\u3002(\u53ef\u9009\uff0c\u9ed8\u8ba4\u4e3a false)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"images[].density")," ",(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number"},"Number"))," \u8868\u793aDPI\u4e3a\u5411\u91cf\u53e0\u52a0\u56fe\u50cf\u6570 (\u53ef\u9009\uff0c\u9ed8\u8ba4 ",(0,i.kt)("inlineCode",{parentName:"li"},"72"),") "),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"images[].raw")," ",(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object"},"Object")," ?")," \u63cf\u8ff0\u4f7f\u7528\u539f\u59cb\u50cf\u7d20\u6570\u636e\u65f6\u7684\u8986\u76d6\u3002 ",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"images[].raw.width")," ",(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number"},"Number")," ?")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"images[].raw.height")," ",(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number"},"Number")," ?")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"images[].raw.channels")," ",(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number"},"Number")," ?")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"images[].animated")," ",(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean"},"boolean")),"  \u52a8\u753b\u5e03\u5c14\u503c\u8bbe\u7f6e\u4e3a ",(0,i.kt)("inlineCode",{parentName:"li"},"true")," \u4ee5\u8bfb\u53d6\u52a8\u753b\u56fe\u50cf\u7684\u6240\u6709\u5e27/\u9875(\u53ef\u9009\uff0c\u9ed8\u8ba4 ",(0,i.kt)("inlineCode",{parentName:"li"},"false"),")"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"images[].failOnError")," ",(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean"},"boolean"))," \u8bf7\u67e5\u770b\u6784\u9020\u51fd\u6570 ",(0,i.kt)("inlineCode",{parentName:"li"},"constructor parameters")," (\u53ef\u9009\uff0c\u9ed8\u8ba4 ",(0,i.kt)("inlineCode",{parentName:"li"},"true"),")"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"images[].limitInputPixels")," ",(0,i.kt)("strong",{parentName:"li"},"(",(0,i.kt)("a",{parentName:"strong",href:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number"},"number")," | ",(0,i.kt)("a",{parentName:"strong",href:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean"},"boolean")," )")," \u8bf7\u67e5\u770b\u6784\u9020\u51fd\u6570 ",(0,i.kt)("inlineCode",{parentName:"li"},"constructor parameters")," (\u53ef\u9009\uff0c\u9ed8\u8ba4 ",(0,i.kt)("inlineCode",{parentName:"li"},"268402689"),")")))),(0,i.kt)("h3",{id:"\u4f8b\u5b50"},"\u4f8b\u5b50"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"await sharp(background)\n  .composite([\n    { input: layer1, gravity: 'northwest' },\n    { input: layer2, gravity: 'southeast' },\n  ])\n  .toFile('combined.png');\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"const output = await sharp('input.gif', { animated: true })\n  .composite([\n    { input: 'overlay.png', tile: true, blend: 'saturate' }\n  ])\n  .toBuffer();\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"sharp('input.png')\n  .rotate(180)\n  .resize(300)\n  .flatten( { background: '#ff6600' } )\n  .composite([{ input: 'overlay.png', gravity: 'southeast' }])\n  .sharpen()\n  .withMetadata()\n  .webp( { quality: 90 } )\n  .toBuffer()\n  .then(function(outputBuffer) {\n    // outputBuffer contains upside down, 300px wide, alpha channel flattened\n    // onto orange background, composited with overlay.png with SE gravity,\n    // sharpened, with metadata, 90% quality WebP image data. Phew!\n  });\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u65e0\u6548\u53c2\u6570\u65f6\u629b\u51fa\u9519\u8bef ",(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Error"},"Error"))," ")),(0,i.kt)("p",null,"\u8fd4\u56de ",(0,i.kt)("strong",{parentName:"p"},"Sharp")," \u5bf9\u8c61"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Meta")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"since"),": 0.22.0")))}d.isMDXComponent=!0}}]);